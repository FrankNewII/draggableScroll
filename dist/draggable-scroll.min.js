!function(e){if("function"==typeof define&&define.amd)define(["jquery"],e);else if("object"==typeof module&&module.exports)module.exports=e(require("jquery"));else{if("undefined"==typeof jQuery)throw new Error("DraggableScroll: Draggable scroll is depended on JQuery. \n            Please append JQuery to document before load DraggableScroll plugin.");e(jQuery)}}(function(s){s.fn.draggableScroll=function e(t){if(!(this instanceof e))return(t=e.validateConfig(t)).$element=this,new e(t);this._config=t,this._$scrolledElm=this._config.$element,this._pressed=!1,this._startX=void 0,this._isAnimate=!1,this._startY=void 0,this._startScrollX=void 0,this._startScrollY=void 0,this._findElm()._appendStyles()._initListeners()};var t,n=s.fn.draggableScroll,e=s.fn.draggableScroll.prototype;n.validateConfig=function(e){switch(typeof e){case"object":return s.extend(n.defaultConfig,e);case"undefined":return s.extend(n.defaultConfig,{});default:throw new Error("DraggableScroll: Undefined type of config argument.")}},n._unitsConverters={px:function(e){return e},vw:(t=s(document),function(e){return t.width()/100*e})},n.addUnitConverter=function(e,t){n._unitsConverters[e]&&console.warn("Converter for "+e+" was changed."),n._unitsConverters[e]=t},n.converterUnitToPxs=function(e,t){var r=n._unitsConverters[t];if(!r)throw new Error('Undefined css units named as: "'+t+'" \n.Add converter ($.fn.draggableScroll.addUnitConverter(unit, convertFunction)) to PXs for that unit, or you have a typo.');return r(e)},n.defaultConfig={scrollX:!0,scrollY:!0,dropOnMouseLeave:!1,animateScrollByControls:!0,animateScrollTime:200,hideScrollbars:!0},e.scrollTo=function(e,t,r){var o,l="scroll"+e.charAt(0).toUpperCase()+e.slice(1);if(void 0!==t)if(r){var s={};s[l]=t,this._$scrolledElm.animate(s,this._config.animateScrollTime),this._isAnimate=!0,setTimeout(function(){this._isAnimate=!1}.bind(this),this._config.animateScrollTime)}else this._$scrolledElm[l](t);else o=this._$scrolledElm[l]();return o},e._findElm=function(){if(this._$scrolledWrapper=this._config.$element,this._$scrolledElm=this._config.$element.find("[data-draggable-scrolled-content]"),0===this._$scrolledElm.length)throw new Error("DraggableScroll: Cannon find scrolled content element. \n            Use [data-draggable-scrolled-content] inside [data-draggable-scroll] container.");if(1<this._$scrolledElm.length)throw new Error("DraggableScroll: Found more than one [data-draggable-scrolled-content] inside [data-draggable-scroll] container.");return this},e._appendStyles=function(){var e=this._config.hideScrollbars;return this._$scrolledWrapper.css("user-select","none"),e&&this._$scrolledWrapper.css("overflow","hidden"),this._$scrolledElm.css({overflow:"scroll",height:e?"calc(100% + 17px)":"100%",width:e?"calc(100% + 17px)":"100%"}),this},e._initListeners=function(){return this._$scrolledElm.on("mousedown",this.__mousedownHandler.bind(this)).on("mouseup",this.__mouseupHandler.bind(this)).on("mousemove",this.__mousemoveHandler.bind(this)),this._$scrolledWrapper.find("[data-draggable-scroll-control]").on("click",this.__controlsClickHandler.bind(this)),this._config.dropOnMouseLeave&&this._$scrolledElm.on("mouseleave",this.__mouseupHandler.bind(this)),this},e.__mouseupHandler=function(){this._pressed=!1,this._$scrolledWrapper.removeClass("scrollDraggable-draging")},e.__mousedownHandler=function(e){this._pressed=!0,this._startX=e.clientX,this._startY=e.clientY,this._startScrollX=this.scrollTo("left"),this._startScrollY=this.scrollTo("top"),this._$scrolledWrapper.addClass("scrollDraggable-draging")},e.__mousemoveHandler=function(e){this._pressed&&(this._config.scrollX&&this.scrollTo("left",this._startScrollX+(this._startX-e.clientX)),this._config.scrollY&&this.scrollTo("top",this._startScrollY+(this._startY-e.clientY)))},e.__controlsClickHandler=function(e){if(!this._isAnimate){var t,r=s(e.target).data("draggableScrollControl").split(":"),o=r[0],l=n.converterUnitToPxs(parseInt(r[1]),r[1].match(/[^\d\.]+/i)[0]);switch(o){case"top":l=0-l,t=this.scrollTo("top");break;case"bottom":t=this.scrollTo("top"),o="top";break;case"left":t=this.scrollTo("left"),l=0-l;break;case"right":o="left",t=this.scrollTo("left")}this.scrollTo(o,t+l,this._config.animateScrollByControls)}};var r=s("[data-draggable-scroll]");r.length&&r.each(function(e,t){s(t).draggableScroll()})});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImRyYWdnYWJsZS1zY3JvbGwuanMiXSwibmFtZXMiOlsiZmFjdG9yeSIsImRlZmluZSIsImFtZCIsIm1vZHVsZSIsImV4cG9ydHMiLCJyZXF1aXJlIiwialF1ZXJ5IiwiRXJyb3IiLCIkIiwiZm4iLCJkcmFnZ2FibGVTY3JvbGwiLCJEcmFnZ2FibGVTY3JvbGwiLCJjb25maWciLCJ0aGlzIiwidmFsaWRhdGVDb25maWciLCIkZWxlbWVudCIsIl9jb25maWciLCJfJHNjcm9sbGVkRWxtIiwiX3ByZXNzZWQiLCJfc3RhcnRYIiwidW5kZWZpbmVkIiwiX2lzQW5pbWF0ZSIsIl9zdGFydFkiLCJfc3RhcnRTY3JvbGxYIiwiX3N0YXJ0U2Nyb2xsWSIsIl9maW5kRWxtIiwiX2FwcGVuZFN0eWxlcyIsIl9pbml0TGlzdGVuZXJzIiwiJGRvYyIsInN0YXRpY3MiLCJwcm90b3R5cGUiLCJjb25mIiwiZXh0ZW5kIiwiZGVmYXVsdENvbmZpZyIsIl91bml0c0NvbnZlcnRlcnMiLCJweCIsImRpZyIsInZ3IiwiZG9jdW1lbnQiLCJ3aWR0aCIsImFkZFVuaXRDb252ZXJ0ZXIiLCJ1bml0IiwiY29udmVydGVyIiwiY29uc29sZSIsIndhcm4iLCJjb252ZXJ0ZXJVbml0VG9QeHMiLCJzY3JvbGxYIiwic2Nyb2xsWSIsImRyb3BPbk1vdXNlTGVhdmUiLCJhbmltYXRlU2Nyb2xsQnlDb250cm9scyIsImFuaW1hdGVTY3JvbGxUaW1lIiwiaGlkZVNjcm9sbGJhcnMiLCJzY3JvbGxUbyIsInR1cm4iLCJ1bml0cyIsImFuaW0iLCJ2YWwiLCJtZXRob2QiLCJjaGFyQXQiLCJ0b1VwcGVyQ2FzZSIsInNsaWNlIiwiYW5pbVBhcmFtIiwiYW5pbWF0ZSIsInNldFRpbWVvdXQiLCJiaW5kIiwiXyRzY3JvbGxlZFdyYXBwZXIiLCJmaW5kIiwibGVuZ3RoIiwiaGlkZVNjcm9sbCIsImNzcyIsIm92ZXJmbG93IiwiaGVpZ2h0Iiwib24iLCJfX21vdXNlZG93bkhhbmRsZXIiLCJfX21vdXNldXBIYW5kbGVyIiwiX19tb3VzZW1vdmVIYW5kbGVyIiwiX19jb250cm9sc0NsaWNrSGFuZGxlciIsInJlbW92ZUNsYXNzIiwiZXYiLCJjbGllbnRYIiwiY2xpZW50WSIsImFkZENsYXNzIiwiY3VycmVudFZhbCIsImRhdGEiLCJ0YXJnZXQiLCJzcGxpdCIsImRpcmVjdGlvbiIsInN0ZXAiLCJwYXJzZUludCIsIm1hdGNoIiwiJGNvbnRhaW5lcnMiLCJlYWNoIiwiaSIsImVsIl0sIm1hcHBpbmdzIjoiQ0FBQSxTQUFBQSxHQUNBLEdBQUEsbUJBQUFDLFFBQUFBLE9BQUFDLElBQ0FELE9BQUEsQ0FBQSxVQUFBRCxRQUVBLEdBQUEsaUJBQUFHLFFBQUFBLE9BQUFDLFFBQ0FELE9BQUFDLFFBQUFKLEVBQUFLLFFBQUEsZUFFQSxDQUNBLEdBQUEsb0JBQUFDLE9BQ0EsTUFBQSxJQUFBQyxNQUFBLCtJQUlBUCxFQUFBTSxTQWJBLENBZUEsU0FBQUUsR0FDQUEsRUFBQUMsR0FBQUMsZ0JBQUEsU0FBQUMsRUFBQUMsR0FDQSxLQUFBQyxnQkFBQUYsR0FJQSxPQUhBQyxFQUFBRCxFQUFBRyxlQUFBRixJQUNBRyxTQUFBRixLQUVBLElBQUFGLEVBQUFDLEdBR0FDLEtBQUFHLFFBQUFKLEVBQ0FDLEtBQUFJLGNBQUFKLEtBQUFHLFFBQUFELFNBQ0FGLEtBQUFLLFVBQUEsRUFDQUwsS0FBQU0sYUFBQUMsRUFDQVAsS0FBQVEsWUFBQSxFQUNBUixLQUFBUyxhQUFBRixFQUNBUCxLQUFBVSxtQkFBQUgsRUFDQVAsS0FBQVcsbUJBQUFKLEVBRUFQLEtBQUFZLFdBQ0FDLGdCQUNBQyxrQkFHQSxJQW1CQUMsRUFuQkFDLEVBQUFyQixFQUFBQyxHQUFBQyxnQkFDQW9CLEVBQUF0QixFQUFBQyxHQUFBQyxnQkFBQW9CLFVBRUFELEVBQUFmLGVBQUEsU0FBQWlCLEdBQ0EsY0FBQSxHQUNBLElBQUEsU0FDQSxPQUFBdkIsRUFBQXdCLE9BQUFILEVBQUFJLGNBQUFGLEdBQ0EsSUFBQSxZQUNBLE9BQUF2QixFQUFBd0IsT0FBQUgsRUFBQUksY0FBQSxJQUNBLFFBQ0EsTUFBQSxJQUFBMUIsTUFBQSx5REFJQXNCLEVBQUFLLGlCQUFBLENBQ0FDLEdBQUEsU0FBQUMsR0FDQSxPQUFBQSxHQUVBQyxJQUNBVCxFQUFBcEIsRUFBQThCLFVBRUEsU0FBQUYsR0FDQSxPQUFBUixFQUFBVyxRQUFBLElBQUFILEtBS0FQLEVBQUFXLGlCQUFBLFNBQUFDLEVBQUFDLEdBQ0FiLEVBQUFLLGlCQUFBTyxJQUNBRSxRQUFBQyxLQUFBLGlCQUFBSCxFQUFBLGlCQUVBWixFQUFBSyxpQkFBQU8sR0FBQUMsR0FHQWIsRUFBQWdCLG1CQUFBLFNBQUFULEVBQUFLLEdBQ0EsSUFBQUMsRUFBQWIsRUFBQUssaUJBQUFPLEdBRUEsSUFBQUMsRUFDQSxNQUFBLElBQUFuQyxNQUFBLGtDQUFBa0MsRUFBQSwrSEFHQSxPQUFBQyxFQUFBTixJQUdBUCxFQUFBSSxjQUFBLENBQ0FhLFNBQUEsRUFDQUMsU0FBQSxFQUNBQyxrQkFBQSxFQUNBQyx5QkFBQSxFQUNBQyxrQkFBQSxJQUNBQyxnQkFBQSxHQUdBckIsRUFBQXNCLFNBQUEsU0FBQUMsRUFBQUMsRUFBQUMsR0FDQSxJQUNBQyxFQURBQyxFQUFBLFNBQUFKLEVBQUFLLE9BQUEsR0FBQUMsY0FBQU4sRUFBQU8sTUFBQSxHQUdBLFFBQUF4QyxJQUFBa0MsRUFFQSxHQUFBQyxFQUFBLENBQ0EsSUFBQU0sRUFBQSxHQUVBQSxFQUFBSixHQUFBSCxFQUVBekMsS0FBQUksY0FDQTZDLFFBQUFELEVBQUFoRCxLQUFBRyxRQUFBa0MsbUJBRUFyQyxLQUFBUSxZQUFBLEVBRUEwQyxXQUFBLFdBQ0FsRCxLQUFBUSxZQUFBLEdBQ0EyQyxLQUFBbkQsTUFBQUEsS0FBQUcsUUFBQWtDLHdCQUdBckMsS0FBQUksY0FBQXdDLEdBQUFILFFBSUFFLEVBQUEzQyxLQUFBSSxjQUFBd0MsS0FHQSxPQUFBRCxHQUdBMUIsRUFBQUwsU0FBQSxXQUlBLEdBSEFaLEtBQUFvRCxrQkFBQXBELEtBQUFHLFFBQUFELFNBQ0FGLEtBQUFJLGNBQUFKLEtBQUFHLFFBQUFELFNBQUFtRCxLQUFBLHFDQUVBLElBQUFyRCxLQUFBSSxjQUFBa0QsT0FDQSxNQUFBLElBQUE1RCxNQUFBLHdKQUdBLEdBQUEsRUFBQU0sS0FBQUksY0FBQWtELE9BQ0EsTUFBQSxJQUFBNUQsTUFBQSxvSEFFQSxPQUFBTSxNQUdBaUIsRUFBQUosY0FBQSxXQUNBLElBQUEwQyxFQUFBdkQsS0FBQUcsUUFDQW1DLGVBaUJBLE9BZkF0QyxLQUFBb0Qsa0JBQ0FJLElBQUEsY0FBQSxRQUVBRCxHQUNBdkQsS0FBQW9ELGtCQUNBSSxJQUFBLFdBQUEsVUFHQXhELEtBQUFJLGNBQ0FvRCxJQUFBLENBQ0FDLFNBQUEsU0FDQUMsT0FBQUgsRUFBQSxvQkFBQSxPQUNBN0IsTUFBQTZCLEVBQUEsb0JBQUEsU0FHQXZELE1BR0FpQixFQUFBSCxlQUFBLFdBY0EsT0FiQWQsS0FBQUksY0FDQXVELEdBQUEsWUFBQTNELEtBQUE0RCxtQkFBQVQsS0FBQW5ELE9BQ0EyRCxHQUFBLFVBQUEzRCxLQUFBNkQsaUJBQUFWLEtBQUFuRCxPQUNBMkQsR0FBQSxZQUFBM0QsS0FBQThELG1CQUFBWCxLQUFBbkQsT0FFQUEsS0FBQW9ELGtCQUNBQyxLQUFBLG1DQUNBTSxHQUFBLFFBQUEzRCxLQUFBK0QsdUJBQUFaLEtBQUFuRCxPQUVBQSxLQUFBRyxRQUFBZ0Msa0JBQ0FuQyxLQUFBSSxjQUFBdUQsR0FBQSxhQUFBM0QsS0FBQTZELGlCQUFBVixLQUFBbkQsT0FHQUEsTUFHQWlCLEVBQUE0QyxpQkFBQSxXQUNBN0QsS0FBQUssVUFBQSxFQUNBTCxLQUFBb0Qsa0JBQUFZLFlBQUEsNEJBR0EvQyxFQUFBMkMsbUJBQUEsU0FBQUssR0FDQWpFLEtBQUFLLFVBQUEsRUFDQUwsS0FBQU0sUUFBQTJELEVBQUFDLFFBQ0FsRSxLQUFBUyxRQUFBd0QsRUFBQUUsUUFDQW5FLEtBQUFVLGNBQUFWLEtBQUF1QyxTQUFBLFFBQ0F2QyxLQUFBVyxjQUFBWCxLQUFBdUMsU0FBQSxPQUNBdkMsS0FBQW9ELGtCQUFBZ0IsU0FBQSw0QkFHQW5ELEVBQUE2QyxtQkFBQSxTQUFBRyxHQUNBakUsS0FBQUssV0FDQUwsS0FBQUcsUUFBQThCLFNBQUFqQyxLQUFBdUMsU0FBQSxPQUFBdkMsS0FBQVUsZUFBQVYsS0FBQU0sUUFBQTJELEVBQUFDLFVBQ0FsRSxLQUFBRyxRQUFBK0IsU0FBQWxDLEtBQUF1QyxTQUFBLE1BQUF2QyxLQUFBVyxlQUFBWCxLQUFBUyxRQUFBd0QsRUFBQUUsWUFJQWxELEVBQUE4Qyx1QkFBQSxTQUFBRSxHQUVBLElBQUFqRSxLQUFBUSxXQUFBLENBR0EsSUFJQTZELEVBSEFDLEVBREEzRSxFQUFBc0UsRUFBQU0sUUFDQUQsS0FBQSwwQkFBQUUsTUFBQSxLQUNBQyxFQUFBSCxFQUFBLEdBQ0FJLEVBQUExRCxFQUFBZ0IsbUJBQUEyQyxTQUFBTCxFQUFBLElBQUFBLEVBQUEsR0FBQU0sTUFBQSxhQUFBLElBR0EsT0FBQUgsR0FDQSxJQUFBLE1BQ0FDLEVBQUEsRUFBQUEsRUFDQUwsRUFBQXJFLEtBQUF1QyxTQUFBLE9BQ0EsTUFDQSxJQUFBLFNBQ0E4QixFQUFBckUsS0FBQXVDLFNBQUEsT0FDQWtDLEVBQUEsTUFDQSxNQUNBLElBQUEsT0FDQUosRUFBQXJFLEtBQUF1QyxTQUFBLFFBQ0FtQyxFQUFBLEVBQUFBLEVBQ0EsTUFDQSxJQUFBLFFBQ0FELEVBQUEsT0FDQUosRUFBQXJFLEtBQUF1QyxTQUFBLFFBSUF2QyxLQUFBdUMsU0FBQWtDLEVBQUFKLEVBQUFLLEVBQUExRSxLQUFBRyxRQUFBaUMsMkJBR0EsSUFBQXlDLEVBQUFsRixFQUFBLDJCQUVBa0YsRUFBQXZCLFFBQ0F1QixFQUFBQyxLQUFBLFNBQUFDLEVBQUFDLEdBQ0FyRixFQUFBcUYsR0FBQW5GIiwiZmlsZSI6ImRyYWdnYWJsZS1zY3JvbGwuanMiLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24gKGZhY3RvcnkpIHtcbiAgICBpZiAodHlwZW9mIGRlZmluZSA9PT0gJ2Z1bmN0aW9uJyAmJiBkZWZpbmUuYW1kKSB7XG4gICAgICAgIGRlZmluZShbJ2pxdWVyeSddLCBmYWN0b3J5KTtcblxuICAgIH0gZWxzZSBpZiAodHlwZW9mIG1vZHVsZSA9PT0gJ29iamVjdCcgJiYgbW9kdWxlLmV4cG9ydHMpIHtcbiAgICAgICAgbW9kdWxlLmV4cG9ydHMgPSBmYWN0b3J5KHJlcXVpcmUoJ2pxdWVyeScpKTtcblxuICAgIH0gZWxzZSB7XG4gICAgICAgIGlmICh0eXBlb2YgalF1ZXJ5ID09PSAndW5kZWZpbmVkJykge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdEcmFnZ2FibGVTY3JvbGw6IERyYWdnYWJsZSBzY3JvbGwgaXMgZGVwZW5kZWQgb24gSlF1ZXJ5LiBcXG5cXFxuICAgICAgICAgICAgUGxlYXNlIGFwcGVuZCBKUXVlcnkgdG8gZG9jdW1lbnQgYmVmb3JlIGxvYWQgRHJhZ2dhYmxlU2Nyb2xsIHBsdWdpbi4nKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZhY3RvcnkoalF1ZXJ5KTtcbiAgICB9XG59KGZ1bmN0aW9uICgkKSB7XG4gICAgJC5mbi5kcmFnZ2FibGVTY3JvbGwgPSBmdW5jdGlvbiBEcmFnZ2FibGVTY3JvbGwoY29uZmlnKSB7XG4gICAgICAgIGlmICghKHRoaXMgaW5zdGFuY2VvZiBEcmFnZ2FibGVTY3JvbGwpKSB7XG4gICAgICAgICAgICBjb25maWcgPSBEcmFnZ2FibGVTY3JvbGwudmFsaWRhdGVDb25maWcoY29uZmlnKTtcbiAgICAgICAgICAgIGNvbmZpZy4kZWxlbWVudCA9IHRoaXM7XG5cbiAgICAgICAgICAgIHJldHVybiBuZXcgRHJhZ2dhYmxlU2Nyb2xsKGNvbmZpZyk7XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLl9jb25maWcgPSBjb25maWc7XG4gICAgICAgIHRoaXMuXyRzY3JvbGxlZEVsbSA9IHRoaXMuX2NvbmZpZy4kZWxlbWVudDtcbiAgICAgICAgdGhpcy5fcHJlc3NlZCA9IGZhbHNlO1xuICAgICAgICB0aGlzLl9zdGFydFggPSB1bmRlZmluZWQ7XG4gICAgICAgIHRoaXMuX2lzQW5pbWF0ZSA9IGZhbHNlO1xuICAgICAgICB0aGlzLl9zdGFydFkgPSB1bmRlZmluZWQ7XG4gICAgICAgIHRoaXMuX3N0YXJ0U2Nyb2xsWCA9IHVuZGVmaW5lZDtcbiAgICAgICAgdGhpcy5fc3RhcnRTY3JvbGxZID0gdW5kZWZpbmVkO1xuXG4gICAgICAgIHRoaXMuX2ZpbmRFbG0oKVxuICAgICAgICAgICAgLl9hcHBlbmRTdHlsZXMoKVxuICAgICAgICAgICAgLl9pbml0TGlzdGVuZXJzKCk7XG4gICAgfTtcblxuICAgIHZhciBzdGF0aWNzID0gJC5mbi5kcmFnZ2FibGVTY3JvbGw7XG4gICAgdmFyIHByb3RvdHlwZSA9ICQuZm4uZHJhZ2dhYmxlU2Nyb2xsLnByb3RvdHlwZTtcblxuICAgIHN0YXRpY3MudmFsaWRhdGVDb25maWcgPSBmdW5jdGlvbiAoY29uZikge1xuICAgICAgICBzd2l0Y2ggKHR5cGVvZiAoY29uZikpIHtcbiAgICAgICAgICAgIGNhc2UgJ29iamVjdCc6XG4gICAgICAgICAgICAgICAgcmV0dXJuICQuZXh0ZW5kKHN0YXRpY3MuZGVmYXVsdENvbmZpZywgY29uZik7XG4gICAgICAgICAgICBjYXNlICd1bmRlZmluZWQnOlxuICAgICAgICAgICAgICAgIHJldHVybiAkLmV4dGVuZChzdGF0aWNzLmRlZmF1bHRDb25maWcsIHt9KTtcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdEcmFnZ2FibGVTY3JvbGw6IFVuZGVmaW5lZCB0eXBlIG9mIGNvbmZpZyBhcmd1bWVudC4nKTtcbiAgICAgICAgfVxuICAgIH07XG5cbiAgICBzdGF0aWNzLl91bml0c0NvbnZlcnRlcnMgPSB7XG4gICAgICAgIHB4OiBmdW5jdGlvbiAoZGlnKSB7XG4gICAgICAgICAgICByZXR1cm4gZGlnO1xuICAgICAgICB9LFxuICAgICAgICB2dzogKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciAkZG9jID0gJChkb2N1bWVudCk7XG5cbiAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbiAoZGlnKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuICRkb2Mud2lkdGgoKSAvIDEwMCAqIGRpZztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSkoKVxuICAgIH07XG5cbiAgICBzdGF0aWNzLmFkZFVuaXRDb252ZXJ0ZXIgPSBmdW5jdGlvbiAodW5pdCwgY29udmVydGVyKSB7XG4gICAgICAgIGlmIChzdGF0aWNzLl91bml0c0NvbnZlcnRlcnNbdW5pdF0pXG4gICAgICAgICAgICBjb25zb2xlLndhcm4oJ0NvbnZlcnRlciBmb3IgJyArIHVuaXQgKyAnIHdhcyBjaGFuZ2VkLicpO1xuXG4gICAgICAgIHN0YXRpY3MuX3VuaXRzQ29udmVydGVyc1t1bml0XSA9IGNvbnZlcnRlcjtcbiAgICB9O1xuXG4gICAgc3RhdGljcy5jb252ZXJ0ZXJVbml0VG9QeHMgPSBmdW5jdGlvbiAoZGlnLCB1bml0KSB7XG4gICAgICAgIHZhciBjb252ZXJ0ZXIgPSBzdGF0aWNzLl91bml0c0NvbnZlcnRlcnNbdW5pdF07XG5cbiAgICAgICAgaWYgKCFjb252ZXJ0ZXIpXG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1VuZGVmaW5lZCBjc3MgdW5pdHMgbmFtZWQgYXM6IFwiJyt1bml0KydcIiBcXG5cXC4nICtcbiAgICAgICAgICAgICAgICAnQWRkIGNvbnZlcnRlciAoJC5mbi5kcmFnZ2FibGVTY3JvbGwuYWRkVW5pdENvbnZlcnRlcih1bml0LCBjb252ZXJ0RnVuY3Rpb24pKSB0byBQWHMgZm9yIHRoYXQgdW5pdCwgb3IgeW91IGhhdmUgYSB0eXBvLicpO1xuXG4gICAgICAgIHJldHVybiBjb252ZXJ0ZXIoZGlnKTtcbiAgICB9O1xuXG4gICAgc3RhdGljcy5kZWZhdWx0Q29uZmlnID0ge1xuICAgICAgICBzY3JvbGxYOiB0cnVlLFxuICAgICAgICBzY3JvbGxZOiB0cnVlLFxuICAgICAgICBkcm9wT25Nb3VzZUxlYXZlOiBmYWxzZSxcbiAgICAgICAgYW5pbWF0ZVNjcm9sbEJ5Q29udHJvbHM6IHRydWUsXG4gICAgICAgIGFuaW1hdGVTY3JvbGxUaW1lOiAyMDAsXG4gICAgICAgIGhpZGVTY3JvbGxiYXJzOiB0cnVlXG4gICAgfTtcblxuICAgIHByb3RvdHlwZS5zY3JvbGxUbyA9IGZ1bmN0aW9uICh0dXJuLCB1bml0cywgYW5pbSkge1xuICAgICAgICB2YXIgbWV0aG9kID0gJ3Njcm9sbCcgKyB0dXJuLmNoYXJBdCgwKS50b1VwcGVyQ2FzZSgpICsgdHVybi5zbGljZSgxKTtcbiAgICAgICAgdmFyIHZhbDtcblxuICAgICAgICBpZiAodW5pdHMgIT09IHVuZGVmaW5lZCkge1xuXG4gICAgICAgICAgICBpZiAoYW5pbSkge1xuICAgICAgICAgICAgICAgIHZhciBhbmltUGFyYW0gPSB7fTtcblxuICAgICAgICAgICAgICAgIGFuaW1QYXJhbVttZXRob2RdID0gdW5pdHM7XG5cbiAgICAgICAgICAgICAgICB0aGlzLl8kc2Nyb2xsZWRFbG1cbiAgICAgICAgICAgICAgICAgICAgLmFuaW1hdGUoYW5pbVBhcmFtLCB0aGlzLl9jb25maWcuYW5pbWF0ZVNjcm9sbFRpbWUpO1xuXG4gICAgICAgICAgICAgICAgdGhpcy5faXNBbmltYXRlID0gdHJ1ZTtcblxuICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLl9pc0FuaW1hdGUgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICB9LmJpbmQodGhpcyksIHRoaXMuX2NvbmZpZy5hbmltYXRlU2Nyb2xsVGltZSk7XG5cbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fJHNjcm9sbGVkRWxtW21ldGhvZF0odW5pdHMpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB2YWwgPSB0aGlzLl8kc2Nyb2xsZWRFbG1bbWV0aG9kXSgpO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHZhbDtcbiAgICB9O1xuXG4gICAgcHJvdG90eXBlLl9maW5kRWxtID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLl8kc2Nyb2xsZWRXcmFwcGVyID0gdGhpcy5fY29uZmlnLiRlbGVtZW50O1xuICAgICAgICB0aGlzLl8kc2Nyb2xsZWRFbG0gPSB0aGlzLl9jb25maWcuJGVsZW1lbnQuZmluZCgnW2RhdGEtZHJhZ2dhYmxlLXNjcm9sbGVkLWNvbnRlbnRdJyk7XG5cbiAgICAgICAgaWYgKHRoaXMuXyRzY3JvbGxlZEVsbS5sZW5ndGggPT09IDApXG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0RyYWdnYWJsZVNjcm9sbDogQ2Fubm9uIGZpbmQgc2Nyb2xsZWQgY29udGVudCBlbGVtZW50LiBcXG5cXFxuICAgICAgICAgICAgVXNlIFtkYXRhLWRyYWdnYWJsZS1zY3JvbGxlZC1jb250ZW50XSBpbnNpZGUgW2RhdGEtZHJhZ2dhYmxlLXNjcm9sbF0gY29udGFpbmVyLicpO1xuXG4gICAgICAgIGlmICh0aGlzLl8kc2Nyb2xsZWRFbG0ubGVuZ3RoID4gMSlcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignRHJhZ2dhYmxlU2Nyb2xsOiBGb3VuZCBtb3JlIHRoYW4gb25lIFtkYXRhLWRyYWdnYWJsZS1zY3JvbGxlZC1jb250ZW50XSBpbnNpZGUgW2RhdGEtZHJhZ2dhYmxlLXNjcm9sbF0gY29udGFpbmVyLicpO1xuXG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH07XG5cbiAgICBwcm90b3R5cGUuX2FwcGVuZFN0eWxlcyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIGhpZGVTY3JvbGwgPSB0aGlzLl9jb25maWdcbiAgICAgICAgICAgIC5oaWRlU2Nyb2xsYmFycztcblxuICAgICAgICB0aGlzLl8kc2Nyb2xsZWRXcmFwcGVyXG4gICAgICAgICAgICAuY3NzKCd1c2VyLXNlbGVjdCcsICdub25lJyk7XG5cbiAgICAgICAgaWYgKGhpZGVTY3JvbGwpIHtcbiAgICAgICAgICAgIHRoaXMuXyRzY3JvbGxlZFdyYXBwZXJcbiAgICAgICAgICAgICAgICAuY3NzKCdvdmVyZmxvdycsICdoaWRkZW4nKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMuXyRzY3JvbGxlZEVsbVxuICAgICAgICAgICAgLmNzcyh7XG4gICAgICAgICAgICAgICAgJ292ZXJmbG93JzogJ3Njcm9sbCcsXG4gICAgICAgICAgICAgICAgJ2hlaWdodCc6IGhpZGVTY3JvbGwgPyAnY2FsYygxMDAlICsgMTdweCknIDogJzEwMCUnLFxuICAgICAgICAgICAgICAgICd3aWR0aCc6IGhpZGVTY3JvbGwgPyAnY2FsYygxMDAlICsgMTdweCknIDogJzEwMCUnLFxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfTtcblxuICAgIHByb3RvdHlwZS5faW5pdExpc3RlbmVycyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5fJHNjcm9sbGVkRWxtXG4gICAgICAgICAgICAub24oJ21vdXNlZG93bicsIHRoaXMuX19tb3VzZWRvd25IYW5kbGVyLmJpbmQodGhpcykpXG4gICAgICAgICAgICAub24oJ21vdXNldXAnLCB0aGlzLl9fbW91c2V1cEhhbmRsZXIuYmluZCh0aGlzKSlcbiAgICAgICAgICAgIC5vbignbW91c2Vtb3ZlJywgdGhpcy5fX21vdXNlbW92ZUhhbmRsZXIuYmluZCh0aGlzKSk7XG5cbiAgICAgICAgdGhpcy5fJHNjcm9sbGVkV3JhcHBlclxuICAgICAgICAgICAgLmZpbmQoJ1tkYXRhLWRyYWdnYWJsZS1zY3JvbGwtY29udHJvbF0nKVxuICAgICAgICAgICAgLm9uKCdjbGljaycsIHRoaXMuX19jb250cm9sc0NsaWNrSGFuZGxlci5iaW5kKHRoaXMpKTtcblxuICAgICAgICBpZiAodGhpcy5fY29uZmlnLmRyb3BPbk1vdXNlTGVhdmUpIHtcbiAgICAgICAgICAgIHRoaXMuXyRzY3JvbGxlZEVsbS5vbignbW91c2VsZWF2ZScsIHRoaXMuX19tb3VzZXVwSGFuZGxlci5iaW5kKHRoaXMpKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH07XG5cbiAgICBwcm90b3R5cGUuX19tb3VzZXVwSGFuZGxlciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5fcHJlc3NlZCA9IGZhbHNlO1xuICAgICAgICB0aGlzLl8kc2Nyb2xsZWRXcmFwcGVyLnJlbW92ZUNsYXNzKCdzY3JvbGxEcmFnZ2FibGUtZHJhZ2luZycpO1xuICAgIH07XG5cbiAgICBwcm90b3R5cGUuX19tb3VzZWRvd25IYW5kbGVyID0gZnVuY3Rpb24gKGV2KSB7XG4gICAgICAgIHRoaXMuX3ByZXNzZWQgPSB0cnVlO1xuICAgICAgICB0aGlzLl9zdGFydFggPSBldi5jbGllbnRYO1xuICAgICAgICB0aGlzLl9zdGFydFkgPSBldi5jbGllbnRZO1xuICAgICAgICB0aGlzLl9zdGFydFNjcm9sbFggPSB0aGlzLnNjcm9sbFRvKCdsZWZ0Jyk7XG4gICAgICAgIHRoaXMuX3N0YXJ0U2Nyb2xsWSA9IHRoaXMuc2Nyb2xsVG8oJ3RvcCcpO1xuICAgICAgICB0aGlzLl8kc2Nyb2xsZWRXcmFwcGVyLmFkZENsYXNzKCdzY3JvbGxEcmFnZ2FibGUtZHJhZ2luZycpO1xuICAgIH07XG5cbiAgICBwcm90b3R5cGUuX19tb3VzZW1vdmVIYW5kbGVyID0gZnVuY3Rpb24gKGV2KSB7XG4gICAgICAgIGlmICh0aGlzLl9wcmVzc2VkKSB7XG4gICAgICAgICAgICB0aGlzLl9jb25maWcuc2Nyb2xsWCAmJiB0aGlzLnNjcm9sbFRvKCdsZWZ0JywgdGhpcy5fc3RhcnRTY3JvbGxYICsgKHRoaXMuX3N0YXJ0WCAtIGV2LmNsaWVudFgpKTtcbiAgICAgICAgICAgIHRoaXMuX2NvbmZpZy5zY3JvbGxZICYmIHRoaXMuc2Nyb2xsVG8oJ3RvcCcsIHRoaXMuX3N0YXJ0U2Nyb2xsWSArICh0aGlzLl9zdGFydFkgLSBldi5jbGllbnRZKSk7XG4gICAgICAgIH1cbiAgICB9O1xuXG4gICAgcHJvdG90eXBlLl9fY29udHJvbHNDbGlja0hhbmRsZXIgPSBmdW5jdGlvbiAoZXYpIHtcblxuICAgICAgICBpZiAodGhpcy5faXNBbmltYXRlKVxuICAgICAgICAgICAgcmV0dXJuO1xuXG4gICAgICAgIHZhciAkdGFyZ2V0ID0gJChldi50YXJnZXQpO1xuICAgICAgICB2YXIgZGF0YSA9ICR0YXJnZXQuZGF0YSgnZHJhZ2dhYmxlU2Nyb2xsQ29udHJvbCcpLnNwbGl0KCc6Jyk7XG4gICAgICAgIHZhciBkaXJlY3Rpb24gPSBkYXRhWzBdO1xuICAgICAgICB2YXIgc3RlcCA9IHN0YXRpY3MuY29udmVydGVyVW5pdFRvUHhzKHBhcnNlSW50KGRhdGFbMV0pLCBkYXRhWzFdLm1hdGNoKC9bXlxcZFxcLl0rL2kpWzBdKTtcbiAgICAgICAgdmFyIGN1cnJlbnRWYWw7XG5cbiAgICAgICAgc3dpdGNoIChkaXJlY3Rpb24pIHtcbiAgICAgICAgICAgIGNhc2UgJ3RvcCc6XG4gICAgICAgICAgICAgICAgc3RlcCA9IDAgLSBzdGVwO1xuICAgICAgICAgICAgICAgIGN1cnJlbnRWYWwgPSB0aGlzLnNjcm9sbFRvKCd0b3AnKTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgJ2JvdHRvbSc6XG4gICAgICAgICAgICAgICAgY3VycmVudFZhbCA9IHRoaXMuc2Nyb2xsVG8oJ3RvcCcpO1xuICAgICAgICAgICAgICAgIGRpcmVjdGlvbiA9ICd0b3AnO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSAnbGVmdCc6XG4gICAgICAgICAgICAgICAgY3VycmVudFZhbCA9IHRoaXMuc2Nyb2xsVG8oJ2xlZnQnKTtcbiAgICAgICAgICAgICAgICBzdGVwID0gMCAtIHN0ZXA7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlICdyaWdodCc6XG4gICAgICAgICAgICAgICAgZGlyZWN0aW9uID0gJ2xlZnQnO1xuICAgICAgICAgICAgICAgIGN1cnJlbnRWYWwgPSB0aGlzLnNjcm9sbFRvKCdsZWZ0Jyk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLnNjcm9sbFRvKGRpcmVjdGlvbiwgY3VycmVudFZhbCArIHN0ZXAsIHRoaXMuX2NvbmZpZy5hbmltYXRlU2Nyb2xsQnlDb250cm9scyk7XG4gICAgfTtcblxuICAgIHZhciAkY29udGFpbmVycyA9ICQoJ1tkYXRhLWRyYWdnYWJsZS1zY3JvbGxdJyk7XG5cbiAgICBpZiAoJGNvbnRhaW5lcnMubGVuZ3RoKSB7XG4gICAgICAgICRjb250YWluZXJzLmVhY2goZnVuY3Rpb24gKGksIGVsKSB7XG4gICAgICAgICAgICAkKGVsKS5kcmFnZ2FibGVTY3JvbGwoKTtcbiAgICAgICAgfSk7XG4gICAgfVxufSkpOyJdfQ==
